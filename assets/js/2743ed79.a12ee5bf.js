"use strict";(globalThis.webpackChunkkodsh_wiki_new=globalThis.webpackChunkkodsh_wiki_new||[]).push([[8626],{28453:(e,n,t)=>{t.d(n,{R:()=>s,x:()=>c});var i=t(96540);const l={},r=i.createContext(l);function s(e){const n=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:s(e.components),i.createElement(r.Provider,{value:n},e.children)}},95730:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>c,default:()=>o,frontMatter:()=>s,metadata:()=>i,toc:()=>a});const i=JSON.parse('{"id":"universal/resources/nitro/graphics_2d/section_mcbk","title":"MCBK (\\"KBCM\\") - Multi Cell Bank","description":"Author(s): Gonhex","source":"@site/docs/universal/resources/nitro/graphics_2d/section_mcbk.md","sourceDirName":"universal/resources/nitro/graphics_2d","slug":"/universal/resources/nitro/graphics_2d/section_mcbk","permalink":"/docs/universal/resources/nitro/graphics_2d/section_mcbk","draft":false,"unlisted":false,"editUrl":"https://github.com/ds-pokemon-hacking/ds-pokemon-hacking.github.io/docs/universal/resources/nitro/graphics_2d/section_mcbk.md","tags":[],"version":"current","frontMatter":{},"sidebar":"universal_sidebar","previous":{"title":"LABL (\\"LBAL\\") - Label","permalink":"/docs/universal/resources/nitro/graphics_2d/section_labl"},"next":{"title":"PCMP (\\"PMCP\\") - Palette Compression","permalink":"/docs/universal/resources/nitro/graphics_2d/section_pcmp"}}');var l=t(74848),r=t(28453);const s={},c='MCBK ("KBCM") - Multi Cell Bank',d={},a=[{value:"Table of Contents",id:"table-of-contents",level:2},{value:"Data Structure",id:"data-structure",level:2},{value:"Section Container",id:"section-container",level:3},{value:"MCBK Container",id:"mcbk-container",level:3},{value:"Multi Cell",id:"multi-cell",level:3},{value:"Multi Cell Properties",id:"multi-cell-properties",level:3},{value:"Specification",id:"specification",level:2},{value:"Frame Mode",id:"frame-mode",level:3},{value:"Files",id:"files",level:3}];function h(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",mermaid:"mermaid",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.header,{children:(0,l.jsx)(n.h1,{id:"mcbk-kbcm---multi-cell-bank",children:'MCBK ("KBCM") - Multi Cell Bank'})}),"\n",(0,l.jsxs)(n.blockquote,{children:["\n",(0,l.jsxs)(n.p,{children:["Author(s): ",(0,l.jsx)(n.a,{href:"https://github.com/Gonhex",children:"Gonhex"})," ",(0,l.jsx)("br",{}),"\r\nResearch: ",(0,l.jsx)(n.a,{href:"https://github.com/Gonhex",children:"Gonhex"})]}),"\n"]}),"\n",(0,l.jsx)(n.mermaid,{value:"flowchart BT;\r\n    NMCR(N. Multi Cell R.)--\x3eG2D(Graphics 2D);\r\n    MCBK(Multi Cell Bank)--\x3eNMCR;"}),"\n",(0,l.jsx)(n.p,{children:"The multi cell bank combines multiple animated cells into cluster. This allows more complex animations by grouping related sequences into one unit."}),"\n",(0,l.jsx)(n.h2,{id:"table-of-contents",children:"Table of Contents"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.a,{href:"#data-structure",children:"Data Structure"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"#section-container",children:"Section Container"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"#mcbk-container",children:"MCBK Container"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"#multi-cell",children:"Multi Cell"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"#multi-cell-properties",children:"Multi Cell Properties"})}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.a,{href:"#specification",children:"Specification"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"#frame-mode",children:"Frame Mode"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"#files",children:"Files"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"data-structure",children:"Data Structure"}),"\n",(0,l.jsx)(n.h3,{id:"section-container",children:"Section Container"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-c",children:"struct ContainerSectionMCBK\r\n{\r\n    /* 0x0 */ struct NitroSectionHeader sectionHeader;\r\n    /* 0x8 */ struct ContainerMCBK sectionData;\r\n}; // entry size = sectionHeader.lengthSection\n"})}),"\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{children:"Field Name"}),(0,l.jsx)(n.th,{children:"Description"}),(0,l.jsx)(n.th,{children:"Data Type"})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"sectionHeader"}),(0,l.jsxs)(n.td,{children:["Header of this section. ",(0,l.jsx)(n.code,{children:'sectionHeader.signature = "KBCM"'}),"."]}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.a,{href:"/docs/universal/resources/nitro/#nitro-section-header",children:"NitroSectionHeader"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"sectionData"}),(0,l.jsx)(n.td,{children:"Content of this section."}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.a,{href:"#mcbk-container",children:"ContainerMCBK"})})]})]})]}),"\n",(0,l.jsx)(n.h3,{id:"mcbk-container",children:"MCBK Container"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-c",children:"struct ContainerMCBK\r\n{\r\n    // header\r\n    /* 0x00 */ uint16_t numberMultiCells;\r\n    /* 0x02 */ uint16_t unknown0;\r\n    /* 0x04 */ uint32_t offsetDataMultiCell;\r\n    /* 0x08 */ uint32_t offsetDataMultiCellProperties;\r\n    /* 0x0C */ uint32_t unknown1;\r\n    /* 0x10 */ uint32_t unknown2;\r\n    \r\n    // data\r\n    /* offsetMultiCell           */ struct MultiCell dataMultiCell[numberMultiCells];\r\n    /* offsetMultiCellProperties */ struct MultiCellProperties dataMultiCellProperties[?];\r\n}; // entry size = sectionHeader.lengthSection - 0x8\n"})}),"\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{children:"Field Name"}),(0,l.jsx)(n.th,{children:"Description"}),(0,l.jsx)(n.th,{children:"Data Type"})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"numberMultiCells"}),(0,l.jsx)(n.td,{children:"Number of multi cell objects."}),(0,l.jsx)(n.td,{children:"uint16_t"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"unknown0"}),(0,l.jsxs)(n.td,{children:["Always ",(0,l.jsx)(n.code,{children:"0xBEEF"}),"."]}),(0,l.jsx)(n.td,{children:"uint16_t"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"offsetDataMultiCell"}),(0,l.jsxs)(n.td,{children:["Offset to the multi cell data section relative to ",(0,l.jsx)(n.code,{children:"ContainerMCBK"}),"."]}),(0,l.jsx)(n.td,{children:"uint32_t"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"offsetDataMultiCellProperties"}),(0,l.jsxs)(n.td,{children:["Offset to the multi cell property data section relative to ",(0,l.jsx)(n.code,{children:"ContainerMCBK"}),"."]}),(0,l.jsx)(n.td,{children:"uint32_t"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"unknown1"}),(0,l.jsx)(n.td,{children:"Unused offset?"}),(0,l.jsx)(n.td,{children:"uint32_t"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"unknown2"}),(0,l.jsx)(n.td,{children:"Unused offset?"}),(0,l.jsx)(n.td,{children:"uint32_t"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"dataMultiCell"}),(0,l.jsx)(n.td,{children:"Multi cell configuration table."}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.a,{href:"#multi-cell",children:"MultiCell"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"dataMultiCellProperties"}),(0,l.jsx)(n.td,{children:"Cell selection and placement data."}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.a,{href:"#multi-cell-properties",children:"MultiCellProperties"})})]})]})]}),"\n",(0,l.jsx)(n.h3,{id:"multi-cell",children:"Multi Cell"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-c",children:"struct MultiCell\r\n{\r\n    /* 0x0 */ uint16_t numberDisplayedCells;\r\n    /* 0x2 */ uint16_t numberLoadedCells;\r\n    /* 0x4 */ uint32_t offsetData;\r\n}; // entry size = 0x8\n"})}),"\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{children:"Field Name"}),(0,l.jsx)(n.th,{children:"Description"}),(0,l.jsx)(n.th,{children:"Data Type"})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"numberDisplayedCells"}),(0,l.jsx)(n.td,{children:"Number of visible multi cells."}),(0,l.jsx)(n.td,{children:"uint16_t"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"numberLoadedCells"}),(0,l.jsx)(n.td,{children:"Number of multi cells within the buffer."}),(0,l.jsx)(n.td,{children:"uint16_t"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"offsetData"}),(0,l.jsxs)(n.td,{children:["Offset of the multi cell relative to ",(0,l.jsx)(n.a,{href:"#multi-cell",children:"MultiCell"}),"."]}),(0,l.jsx)(n.td,{children:"uint32_t"})]})]})]}),"\n",(0,l.jsx)(n.h3,{id:"multi-cell-properties",children:"Multi Cell Properties"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-c",children:"struct MultiCellProperties\r\n{\r\n    /* 0x0 */ uint16_t indexSequence;\r\n    /* 0x2 */ int16_t translateX;\r\n    /* 0x4 */ int16_t translateY;\r\n    /* 0x6 */ uint8_t frameMode;\r\n    /* 0x7 */ uint8_t uniqueID;\r\n}; // entry size = 0x8\n"})}),"\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{children:"Field Name"}),(0,l.jsx)(n.th,{children:"Description"}),(0,l.jsx)(n.th,{children:"Data Type"})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"indexSequence"}),(0,l.jsx)(n.td,{children:"Selects a sequence from the animation runtime."}),(0,l.jsx)(n.td,{children:"uint16_t"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"translateX"}),(0,l.jsx)(n.td,{children:"X translation of the animated base."}),(0,l.jsx)(n.td,{children:"int16_t"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"translateY"}),(0,l.jsx)(n.td,{children:"Y translation of the animated base."}),(0,l.jsx)(n.td,{children:"int16_t"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"frameMode"}),(0,l.jsxs)(n.td,{children:["Behavior of the frame counter, if cell is temporary unloaded, see ",(0,l.jsx)(n.a,{href:"#frame-mode",children:"Frame Mode"}),"."]}),(0,l.jsx)(n.td,{children:"uint8_t"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"uniqueID"}),(0,l.jsxs)(n.td,{children:["Local multi cell index starting by ",(0,l.jsx)(n.code,{children:"0"}),". No duplicates allowed."]}),(0,l.jsx)(n.td,{children:"uint8_t"})]})]})]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"specification",children:"Specification"}),"\n",(0,l.jsx)(n.h3,{id:"frame-mode",children:"Frame Mode"}),"\n",(0,l.jsx)(n.p,{children:"Defines the behavior of a sequence if the displayed multicell changes."}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"0x20"}),": Reset the frame counter. The sequence will start from the beginning after the multicell regains focus."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"0x21"}),": Continue counting. The sequence will continue counting frames even if the multicell lost focus, no restart after regaining it."]}),"\n"]}),"\n",(0,l.jsxs)(n.p,{children:["This value is probably a bitfield. This would explain the leading ",(0,l.jsx)(n.code,{children:"2"})," which implies an always enabled flag."]}),"\n",(0,l.jsx)(n.h3,{id:"files",children:"Files"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"/docs/universal/resources/nitro/graphics_2d/file_nmcr",children:"Nitro Multi Cell Runtime"})}),"\n"]})]})}function o(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(h,{...e})}):h(e)}}}]);