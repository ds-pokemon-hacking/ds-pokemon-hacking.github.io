<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-generation-iv/guides/pt-reusable_repel/pt-reusable_repel" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">Reusable Repel | DS Pokémon Hacking</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://ds-pokemon-hacking.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://ds-pokemon-hacking.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://ds-pokemon-hacking.github.io/docs/generation-iv/guides/pt-reusable_repel/"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Reusable Repel | DS Pokémon Hacking"><meta data-rh="true" name="description" content="Author: SpagoAsparago"><meta data-rh="true" property="og:description" content="Author: SpagoAsparago"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://ds-pokemon-hacking.github.io/docs/generation-iv/guides/pt-reusable_repel/"><link data-rh="true" rel="alternate" href="https://ds-pokemon-hacking.github.io/docs/generation-iv/guides/pt-reusable_repel/" hreflang="en"><link data-rh="true" rel="alternate" href="https://ds-pokemon-hacking.github.io/docs/generation-iv/guides/pt-reusable_repel/" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Guides","item":"https://ds-pokemon-hacking.github.io/docs/category/guides"},{"@type":"ListItem","position":2,"name":"Reusable Repel","item":"https://ds-pokemon-hacking.github.io/docs/generation-iv/guides/pt-reusable_repel/"}]}</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.c8c8a929.css">
<script src="/assets/js/runtime~main.7f4f7ac9.js" defer="defer"></script>
<script src="/assets/js/main.041c4eba.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/kodsh.png" alt="DS Pokémon Hacking Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/kodsh.png" alt="DS Pokémon Hacking Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">DS Pokémon Hacking</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/category/guides">Generation IV</a><a class="navbar__item navbar__link" href="/docs/category/guides-1">Generation V</a><a class="navbar__item navbar__link" href="/docs/category/guides-2">Universal</a><a class="navbar__item navbar__link" href="/contributing">Contributing</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/ds-pokemon-hacking/ds-pokemon-hacking.github.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/docs/category/guides">Guides</a><button aria-label="Collapse sidebar category &#x27;Guides&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/generation-iv/guides/hgss-code_injection/">Code Injection</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/generation-iv/guides/hgss-new_overworlds/">Adding New Overworlds in HeartGold Engine</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/generation-iv/guides/hgss-new_script_commands/">Creating New Script Commands in HeartGold Engine</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/generation-iv/guides/hgss-town_map/">Editing the Town Map</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/generation-iv/guides/ncer_sprite_editing/">Cell Editing for Sprites</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/generation-iv/guides/overworld_sprites/">Overworld Sprite Replacement Guide</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/generation-iv/guides/pt-reusable_repel/">Reusable Repel</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/generation-iv/guides/pt-trainer_code_expansion/">Optimizing and Expanding Functionality for Trainer Pokemon</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/generation-iv/guides/pt-type_expansion/">Type Expansion</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/generation-iv/guides/pt_hgss-hp_bar_speed/">Changing the HP bar Speed</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/generation-iv/guides/pt_hgss-pokemarts/">Adding New Poké Marts</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/generation-iv/guides/pt_hgss-reusabletms/">Enabling Reusable TMs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/generation-iv/guides/pt_hgss-script_weather/">Setting the Weather From a Script</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/resources">Resources</a><button aria-label="Expand sidebar category &#x27;Resources&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_z5aJ"><div class="docItemContainer_c0TR"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/docs/category/guides"><span>Guides</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Reusable Repel</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_bxCs"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-footer-tags-row row margin-bottom--sm"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/docs/tags/guide-platinum">Guide (Platinum)</a></li></ul></div></div><div class="theme-doc-markdown markdown"><header><h1>Reusable Repel<sup><em>(Platinum)</em></sup></h1></header>
<blockquote>
<p>Author: SpagoAsparago <br>
Credits: SpagoAsparago (Implementation), BluRose (Help with ASM), brahulus (Repel AR Code)</p>
</blockquote>
<p>This is a tutorial on how to implement the reusable repel in Platinum.
When the repel runs out, a prompt will appear, from which the player can choose to use another repel:</p>
<p><img decoding="async" loading="lazy" src="/assets/images/pt_reusable_repel-9c50fa6d02564c91e847b79bb8579ac2.png" width="256" height="190" class="img_ev3q"></p>
<p>The options only appear if the player has the appropriate repel item(s) in the bag</p>
<p>You&#x27;ll need to use <a href="https://github.com/AdAstra-LD/DS-Pokemon-Rom-Editor/releases" target="_blank" rel="noopener noreferrer">DSPRE</a> and a Hex Editor. If you don&#x27;t know how to hex edit, check out the <a href="/docs/universal/guides/hex_editing/">Hex Editing Guide</a></p>
<p>This <strong>only works on the US Version of the game</strong>. Attempting to replace the same bytes on a different language game will not work.</p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="table-of-contents">Table of Contents<a href="#table-of-contents" class="hash-link" aria-label="Direct link to Table of Contents" title="Direct link to Table of Contents">​</a></h2>
<ul>
<li><a href="#dspre">DSPRE</a>
<ul>
<li><a href="#scripting">Scripting</a></li>
<li><a href="#text">Text</a></li>
</ul>
</li>
<li><a href="#hex-editing">Hex Editing</a></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="dspre">DSPRE<a href="#dspre" class="hash-link" aria-label="Direct link to DSPRE" title="Direct link to DSPRE">​</a></h2>
<p>If you don&#x27;t have one already, create a new project by loading your ROM in DSPRE. Then go to the <em>Scripting</em> tab.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="scripting">Scripting<a href="#scripting" class="hash-link" aria-label="Direct link to Scripting" title="Direct link to Scripting">​</a></h3>
<p>Go to <code>Script 33</code> replace it with the following:</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Script 33</summary><div><div class="collapsibleContent_i85q"><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Script 33:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	PlayFanfare 1500</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	LockAll</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CheckPlayerHasItem 79 1 0x800C</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	CompareVarValue 0x800C 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	JumpIf EQUAL Function#177</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	CheckPlayerHasItem 76 1 0x800C</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	CompareVarValue 0x800C 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	JumpIf EQUAL Function#177</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	CheckPlayerHasItem 77 1 0x800C</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	CompareVarValue 0x800C 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	JumpIf EQUAL Function#177</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	Message 79</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	WaitAB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	CloseMessage</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	ReleaseAll</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End</span><br></span></code></pre></div></div></div></div></details>
<p>Next go to the <em>Functions</em> tab and add the following functions. If the functions 177+ already exist, adjust the new function IDs accordingly so that no functions are replaced.</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Functions</summary><div><div class="collapsibleContent_i85q"><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Function 177:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Message 75</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	YesNoBox 0x800C</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	CompareVarValue 0x800C 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	JumpIf EQUAL Function#178</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	CloseMessage</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	ReleaseAll</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Function 178:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CloseMessage</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	MultiStandardText 1 1 0 1 0x800C</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	CheckPlayerHasItem 79 1 0x8000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	CompareVarValue 0x8000 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	CallIf EQUAL Function#179</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	CheckPlayerHasItem 76 1 0x8000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	CompareVarValue 0x8000 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	CallIf EQUAL Function#180</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	CheckPlayerHasItem 77 1 0x8000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	CompareVarValue 0x8000 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	CallIf EQUAL Function#181</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	ShowMulti</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	CompareVarValue 0x800C 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	JumpIf EQUAL Function#182</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	CompareVarValue 0x800C 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	JumpIf EQUAL Function#183</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	CompareVarValue 0x800C 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	JumpIf EQUAL Function#184</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	ReleaseAll</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Function 179:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    AddMultiOption 30 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Return</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Function 180:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    AddMultiOption 31 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Return</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Function 181:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    AddMultiOption 32 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Return</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Function 182:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  AdrsValueSet 0x023DFF28 100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	DummyTakeTrap</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  TakeItem 79 1 0x8000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	TextPlayerName 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	TextItem 1 79</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	Message 72</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	WaitButton</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	CloseMessage</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Return</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Function 183:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    AdrsValueSet 0x023DFF28 150</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	DummyTakeTrap</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    TakeItem 76 1 0x8000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	TextPlayerName 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	TextItem 1 76</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	Message 72</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	WaitButton</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	CloseMessage</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Return</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Function 184:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  AdrsValueSet 0x023DFF28 250</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	DummyTakeTrap</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  TakeItem 77 1 0x8000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	TextPlayerName 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	TextItem 1 77</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	Message 72</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	WaitButton</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	CloseMessage</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Return</span><br></span></code></pre></div></div></div></div></details>
<p>Save the script file.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="text">Text<a href="#text" class="hash-link" aria-label="Direct link to Text" title="Direct link to Text">​</a></h3>
<p>Go to the <em>Text Editor</em> tab. Remember to save each Text Archive before moving on to the next one.</p>
<ul>
<li>Open <code>Text Archive 361</code>, and replace messages 30, 31 and 32 respectively with:<!-- -->
<ul>
<li>Repel</li>
<li>Super Repel</li>
<li>Max Repel</li>
</ul>
</li>
<li>Open <code>Text Archive 213</code>, and replace message 72 with:<!-- -->
<ul>
<li><em>Repel’s effect wore off...\nWould you like to use another one?</em></li>
</ul>
</li>
<li>Open <code>Text Archive 213</code>, and replace message 75 with:<!-- -->
<ul>
<li><em>\v0103ぁ\x0000\x0000 used the\n\v0108ぁ\x0001\x0000.\rWild Pokémon will be repelled.</em></li>
</ul>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="hex-editing">Hex Editing<a href="#hex-editing" class="hash-link" aria-label="Direct link to Hex Editing" title="Direct link to Hex Editing">​</a></h2>
<p>If you haven&#x27;t already, you need to expand the arm9 trough DSPRE&#x27;s ROM Toolbox. You can do so by clicking the Explorer Kit Icon in the top bar and applying the <em>ARM9 Expansion</em> patch.</p>
<p>In the folder where your ROM is located, DSPRE should have created a folder name yourROMname_DSPRE_Contents. Inside that you&#x27;ll find a file called <code>arm9.bin</code>, open it in your hex editor of choice.</p>
<p>Go to the offset <code>0x4EAE8</code> and replace all the bytes from this offset with the following sequence:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">0B 48 01 68 0B 48 09 18 0B 48 02 78 0A 70 C0 46 C0 46 C0 46 C0 46 C0 46 C0 46 C0 46 C0 46 C0 46 C0 46 C0 46 C0 46 C0 46 C0 46 C0 46 C0 46 70 47 40 1D 10 02 87 80 00 00 28 FF 3D 02</span><br></span></code></pre></div></div>
<p>Do <strong>not</strong> add new bytes. In HxD you can paste without replacing with the Ctrl+B shortcut. Save the file.</p>
<p>Now you can load DSPRE again and save the ROM. Remember to <strong>not</strong> re-extract the contents, otherwise your hex editing will be lost!</p>
<p>The custom command works by setting the repel counter at the byte written at 15FEE in weather_sys_9.bin, so remember to don&#x27;t write anything at this offset!</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Detailed Explanation for the Custom Command and Repel Counter</summary><div><div class="collapsibleContent_i85q"><p>The repel counter is a dynamic offset located at (Address at 0x02101D40) + (0x8087). This is only valid for the US version, hence my code won&#x27;t work on other regions without writing a new custom command.</p><p>When the repel counter runs out, the game will automatically execute Script 33 in Script File 211.</p><p>After the scripting and hex edits performed, now Script 33 will:</p><ol>
<li>Check if the player has any repel item in their bag</li>
<li>If they do, ask if they wants to use anothe repel</li>
<li>If they want to, create a popup window containing all the available repel items</li>
<li>Remove the repel item that has been chosen from the bag</li>
<li>Use the <code>AdrsValueSet</code> command to write a byte at the offset 0x023DFF28, containing the number of steps of the selected repel</li>
<li>Trough the <code>DummyTakeTrap</code>, the repel counter is increased by the previously set value</li>
</ol><p>The <code>DummyTakeTrap</code> command is otherwise unused, so it&#x27;s been replaced with a custom one in order to access the dynamic offset of the repel counter, and set the counter to the new value.
The custom command is necessary as there is no way to access the dynamic offset using only vanilla scripting commands.
This is the raw assembly code:</p><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>ASM Code</summary><div><div class="collapsibleContent_i85q"><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ldr r0, =0x02101D40</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ldr r1, [r0]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ldr r0, =0x8087</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">add r1, r0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ldr r0, =0x023DDFEE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ldrb r2, [r0]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">strb r2, [r1]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">nop</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">nop</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">nop</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">nop</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">nop</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">nop</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">nop</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">nop</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">nop</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">nop</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">nop</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">nop</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">nop</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">nop</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">nop</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">nop</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">bx lr</span><br></span></code></pre></div></div></div></div></details><p>This part of the code:</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ldr r0, =0x02101D40</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ldr r1, [r0]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ldr r0, =0x8087</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">add r1, r0</span><br></span></code></pre></div></div><p>Is used to calculate the dynamic offset by loading the address at 0x2101D40 and then adding 0x8087 to it, storing the repel counter offset in the R1 register.</p><p>The following part:</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ldr r0, =0x023DDFEE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ldrb r2, [r0]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">strb r2, [r1]</span><br></span></code></pre></div></div><p>Is used to read the byte previously written at 0x023DDFEE by the <code>AdrsValueSet</code> command, and updating the repel counter with it.
The 0x023DDFEE offset is at a region in the RAM otherwise unused, but costantly loaded trough the syntehtic overlay.</p><p>The remaining <code>nop</code> commands are there to maintain the original command dimension and prevent the script command table from being read incorrectly.</p></div></div></details></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/ds-pokemon-hacking/ds-pokemon-hacking.github.io/docs/generation-iv/guides/pt-reusable_repel/pt-reusable_repel.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_VsjB"></div></div></footer></article><nav class="pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/generation-iv/guides/overworld_sprites/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Overworld Sprite Replacement Guide</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/generation-iv/guides/pt-trainer_code_expansion/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Optimizing and Expanding Functionality for Trainer Pokemon</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#table-of-contents" class="table-of-contents__link toc-highlight">Table of Contents</a></li><li><a href="#dspre" class="table-of-contents__link toc-highlight">DSPRE</a><ul><li><a href="#scripting" class="table-of-contents__link toc-highlight">Scripting</a></li><li><a href="#text" class="table-of-contents__link toc-highlight">Text</a></li></ul></li><li><a href="#hex-editing" class="table-of-contents__link toc-highlight">Hex Editing</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 DS Pokémon Hacking. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>