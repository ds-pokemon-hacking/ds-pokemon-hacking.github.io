<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-generation-v/guides/b2w2-code_injection_set_up/b2w2-code_injection_set_up" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">Code Injection set up | DS Pokémon Hacking</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://ds-pokemon-hacking.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://ds-pokemon-hacking.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://ds-pokemon-hacking.github.io/docs/generation-v/guides/b2w2-code_injection_set_up/"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Code Injection set up | DS Pokémon Hacking"><meta data-rh="true" name="description" content="Author(s): Dararo"><meta data-rh="true" property="og:description" content="Author(s): Dararo"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://ds-pokemon-hacking.github.io/docs/generation-v/guides/b2w2-code_injection_set_up/"><link data-rh="true" rel="alternate" href="https://ds-pokemon-hacking.github.io/docs/generation-v/guides/b2w2-code_injection_set_up/" hreflang="en"><link data-rh="true" rel="alternate" href="https://ds-pokemon-hacking.github.io/docs/generation-v/guides/b2w2-code_injection_set_up/" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Guides","item":"https://ds-pokemon-hacking.github.io/docs/category/guides-1"},{"@type":"ListItem","position":2,"name":"Code Injection set up","item":"https://ds-pokemon-hacking.github.io/docs/generation-v/guides/b2w2-code_injection_set_up/"}]}</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.c8c8a929.css">
<script src="/assets/js/runtime~main.7f4f7ac9.js" defer="defer"></script>
<script src="/assets/js/main.041c4eba.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/kodsh.png" alt="DS Pokémon Hacking Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/kodsh.png" alt="DS Pokémon Hacking Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">DS Pokémon Hacking</b></a><a class="navbar__item navbar__link" href="/docs/category/guides">Generation IV</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/category/guides-1">Generation V</a><a class="navbar__item navbar__link" href="/docs/category/guides-2">Universal</a><a class="navbar__item navbar__link" href="/contributing">Contributing</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/ds-pokemon-hacking/ds-pokemon-hacking.github.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/docs/category/guides-1">Guides</a><button aria-label="Collapse sidebar category &#x27;Guides&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/generation-v/guides/b2w2-code_injection_set_up/">Code Injection set up</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/generation-v/guides/b2w2-fairy/">Fairy Type Implementation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/generation-v/guides/bw_b2w2-code_injection/">Code Injection (Generation V)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/generation-v/guides/bw_b2w2-map_insertion/">Map Insertion (Generation V)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/generation-v/guides/bw_b2w2-pokescript01/">Hands-on with PokéScript: Our First Script</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/generation-v/guides/bw_b2w2-pokescript02/">Hands-on with PokéScript: Yes, No, Maybe a Battle So</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/generation-v/guides/bw_b2w2-using_ctrmap/">Using CTRMap</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/resources-1">Resources</a><button aria-label="Expand sidebar category &#x27;Resources&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_z5aJ"><div class="docItemContainer_c0TR"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/docs/category/guides-1"><span>Guides</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Code Injection set up</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_bxCs"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-footer-tags-row row margin-bottom--sm"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/docs/tags/guide-black-2">Guide (Black 2)</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/docs/tags/guide-white-2">Guide (White 2)</a></li></ul></div></div><div class="theme-doc-markdown markdown"><header><h1>Code Injection set up</h1></header>
<blockquote>
<p>Author(s): <a href="https://github.com/Paideieitor" target="_blank" rel="noopener noreferrer">Dararo</a> <br></p>
</blockquote>
<p>This guide will take you thought the steps to get a working Code Injection environment to make your own patches and/or compile patches from other people in Gen V games (White 2 recommended).</p>
<p>This is a practical guide so it doesn&#x27;t stop to explain the reason behind the steps, it is NOT a replacement for the <a href="/docs/generation-v/guides/bw_b2w2-code_injection">Code Injection guide</a>, but it should help getting started in a practical way. It should also do the trick if you only want to compile a patch, even if you can&#x27;t code yourself.</p>
<p>Disclaimers:</p>
<ul>
<li>The guide uses Windows 10 and <a href="https://visualstudio.microsoft.com/es/" target="_blank" rel="noopener noreferrer">Visual Studio</a>, you can use other operating systems and IDEs as long as the tools are compatible, but most steps in this guide will not be valid for you and you will have to find out how to do them in your set up</li>
<li>The guide assumes a general knowledge of C/C++ and basic UI navigation capabilities</li>
<li>This is one way to set up your environment, there are diferent ways to do this</li>
</ul>
<p>Before starting I recomend creating a <code>CodeInjection</code> folder to store all code injection related files and applications.</p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="table-of-contents">Table of Contents<a href="#table-of-contents" class="hash-link" aria-label="Direct link to Table of Contents" title="Direct link to Table of Contents">​</a></h2>
<ul>
<li><a href="#environment-set-up">Environment set up</a>
<ul>
<li><a href="#file-structure">File structure</a></li>
<li><a href="#vs-project-set-up">VS Project set up</a></li>
<li><a href="#ctrmap-set-up">CTRMap set up</a></li>
<li><a href="#ctrmap-project-set-up">CTRMap project set up</a></li>
</ul>
</li>
<li><a href="#making-a-code-injection-patch">Making a Code Injection patch</a>
<ul>
<li><a href="#ida-pseudocode-to-compilable-code">IDA pseudocode to compilable code</a></li>
<li><a href="#compiling-a-patch">Compiling a patch</a></li>
<li><a href="#injecting-a-patch">Injecting a patch</a></li>
</ul>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="environment-set-up">Environment set up<a href="#environment-set-up" class="hash-link" aria-label="Direct link to Environment set up" title="Direct link to Environment set up">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="file-structure">File structure<a href="#file-structure" class="hash-link" aria-label="Direct link to File structure" title="Direct link to File structure">​</a></h3>
<ol>
<li>Create an Empty C++ Project inside of the <code>CodeInjection</code> folder, for this guide it will be called PW2Code</li>
<li>Create a folder named &quot;ExternalDependencies&quot; at <code>CodeInjection/PW2Code</code></li>
<li>Clone the <a href="https://github.com/ds-pokemon-hacking/swan" target="_blank" rel="noopener noreferrer">SWAN repositiory</a> in the <code>CodeInjection/PW2Code/ExternalDependencies</code> folder</li>
<li>Clone the <a href="https://github.com/HelloOO7/NitroKernel" target="_blank" rel="noopener noreferrer">NitroKernel repositiory</a> in the <code>CodeInjection/PW2Code/ExternalDependencies</code> folder</li>
<li>Clone the <a href="https://github.com/HelloOO7/ExtLib" target="_blank" rel="noopener noreferrer">ExtLib repositiory</a> in the <code>CodeInjection/PW2Code/ExternalDependencies</code> folder</li>
<li>Clone the <a href="https://github.com/HelloOO7/libRPM" target="_blank" rel="noopener noreferrer">libRPM repositiory</a> in the <code>CodeInjection/PW2Code/ExternalDependencies</code> folder</li>
<li>Create <code>CodeInjection/PW2Code/Patches</code> (here will go all your code)</li>
</ol>
<p>File structure should look like this:</p>
<ul>
<li>CodeInjection<!-- -->
<ul>
<li>PW2Code<!-- -->
<ul>
<li>ExternalDependencies<!-- -->
<ul>
<li>ExtLib</li>
<li>libRPM</li>
<li>NitroKernel</li>
<li>swan</li>
</ul>
</li>
<li>Patches</li>
<li>PW2Code.sln</li>
<li>PW2Code.vcxproj</li>
<li>PW2Code.vcxproj.filters</li>
<li>PW2Code.vcxproj.user</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="vs-project-set-up">VS Project set up<a href="#vs-project-set-up" class="hash-link" aria-label="Direct link to VS Project set up" title="Direct link to VS Project set up">​</a></h3>
<ol>
<li>Open the project with Visual Studio</li>
<li>In the &quot;Solution Explorer&quot; view, click the <code>Show All Files</code> button (shows all the files in the project folder)
<img decoding="async" loading="lazy" src="/assets/images/vs_show_all_files-4a69374d512e6335a78d48245d5fcd01.png" width="500" height="292" class="img_ev3q"></li>
<li>In the &quot;Solution Explorer&quot; view, select all the folders, &quot;Right-Click&quot; it and select the <code>Include In Project</code> option
<img decoding="async" loading="lazy" src="/assets/images/vs_include_in_project-93a178f88d7c124d9741cc48c93b58fe.png" width="449" height="467" class="img_ev3q"></li>
<li>In the &quot;Solution Explorer&quot; view, &quot;Right-Click&quot; the project and select <code>Properties</code></li>
<li>Go to <code>Configuration Properties -&gt; VC++ Directories -&gt; Include Directories</code> and select <code>&lt;Edit...&gt;</code>
<img decoding="async" loading="lazy" src="/assets/images/vs_include_paths_edit-54b2a6b7b2a74a93bef481b7f3c78c08.png" width="784" height="542" class="img_ev3q"></li>
<li>In the &quot;Include Directories&quot; window, paste <code>$(ProjectDir)ExternalDependencies/swan</code>, <code>$(ProjectDir)ExternalDependencies/NitroKernel/include</code>, <code>$(ProjectDir)ExternalDependencies/ExtLib</code> and <code>$(ProjectDir)ExternalDependencies/libRPM/include</code> or use the <code>...</code> button to look them up
<img decoding="async" loading="lazy" src="/assets/images/vs_add_include_path-8356b4f58a91869f796b9f4438ac8b87.png" width="428" height="423" class="img_ev3q"></li>
<li>Click <code>Ok</code> and remember to click <code>Accept</code> in the <code>Properties</code> window to save the changes</li>
</ol>
<p>Now whenever you create a CPP file in the Patches folder you will be able to include any SWAN header and use its definitions.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="ctrmap-set-up">CTRMap set up<a href="#ctrmap-set-up" class="hash-link" aria-label="Direct link to CTRMap set up" title="Direct link to CTRMap set up">​</a></h3>
<p>For more in-depth CTRMap installation instructions check this <a href="/docs/generation-v/guides/bw_b2w2-using_ctrmap/#setup">guide</a>.</p>
<ol>
<li>Download <a href="https://github.com/ds-pokemon-hacking/CTRMap-CE/releases" target="_blank" rel="noopener noreferrer">CTRMap-Community Edition</a></li>
<li>Download the <a href="https://github.com/ds-pokemon-hacking/CTRMapV/releases" target="_blank" rel="noopener noreferrer">CTRMapV plug-in</a></li>
<li>Open CTRMap, select the CTRMap checkbox and click <code>Launch</code></li>
<li>In the &quot;CTRMap Project Manager&quot; window, go to the <code>Games</code> tab, click the <code>Add ROM</code> button and select your USA White 2 NDS file</li>
<li>In the &quot;CTRMap Project Manager&quot; window, go to the <code>Additional plug-ins</code> tab and click the <code>Install plug-in</code> button</li>
<li>Select the CTRMapV plug-in that you downloaded and install it</li>
</ol>
<p>Now you can create Gen V CTRMap projects compatible with Code Injection.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="ctrmap-project-set-up">CTRMap project set up<a href="#ctrmap-project-set-up" class="hash-link" aria-label="Direct link to CTRMap project set up" title="Direct link to CTRMap project set up">​</a></h3>
<p>This steps are required everytime you create a new project where you intend to use Code Injection, but only once per project.</p>
<ol>
<li>Open CTRMap, select the CTRMap checkbox and click <code>Launch</code></li>
<li>Click <code>File -&gt; Create New Project</code> and select the path of the project, for this example <code>CodeInjection/CTRMapProject</code></li>
<li>Click the <code>Open</code> button to open the project</li>
<li>Download <a href="https://github.com/ds-pokemon-hacking/PMC/releases" target="_blank" rel="noopener noreferrer">PMC</a></li>
<li>In CTRMap, go to the <code>Extras</code> tab and click the <code>Install/Update PMC</code> button and select the PMC you downloaded (<code>PMC_W2.rpm</code> for White 2, <code>PMC_B2.rpm</code> for Black 2)</li>
<li>Make sure there is a patches directory at <code>vfs/data/patches</code>, if there isn&#x27;t create one</li>
<li>Download the latest <a href="https://github.com/HelloOO7/NitroKernel/releases" target="_blank" rel="noopener noreferrer">NitroKernel</a> DLL, if you use DeSmuMe download the <code>NitroKernel_DeSmuMe.dll</code> (recomended)</li>
<li>In the file explorer, go to the <code>CodeInjection/CTRMapProject/vfs/data/patches</code> folder and add the DLL you downloaded</li>
</ol>
<p>This Project is now ready to inject your ASM, C and C++ patches.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="making-a-code-injection-patch">Making a Code Injection patch<a href="#making-a-code-injection-patch" class="hash-link" aria-label="Direct link to Making a Code Injection patch" title="Direct link to Making a Code Injection patch">​</a></h2>
<p>In this guide we will make a Code Injection patch for White 2 that doubles the amount of items the player gets, although pretty much useless this should teach the basic steps to make a patch from start to finish.</p>
<ul>
<li>This guide uses White 2 since it is more researched but it also works for Black 2 if you have the correct IDBs</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="external-tools">External Tools<a href="#external-tools" class="hash-link" aria-label="Direct link to External Tools" title="Direct link to External Tools">​</a></h3>
<p>This are the tools you will need to get started making your Code Injection patches:</p>
<ul>
<li><a href="https://developer.arm.com/downloads/-/arm-gnu-toolchain-downloads" target="_blank" rel="noopener noreferrer">ARM GNU Toolchain</a></li>
<li>IDA Pro (any disassembler works, but most of the research and documentation has been done in IDA and thus stored in IDB files which you will have to convert if you are using a different program)</li>
<li>White 2 IDBs (you can get them in the <a href="https://discord.gg/zAtqJDW2jC" target="_blank" rel="noopener noreferrer">Kingdom of DS Hacking Discord</a> )</li>
<li><a href="https://github.com/TASEmulators/desmume/releases" target="_blank" rel="noopener noreferrer">DeSmuMe</a>, make sure that the console is enabled at <code>Tools -&gt; Console -&gt; Enabled</code></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="idb-research">IDB research<a href="#idb-research" class="hash-link" aria-label="Direct link to IDB research" title="Direct link to IDB research">​</a></h3>
<p>We want to duplicate the amount of items the player gets so we want to look in the IDBs for the function that Adds an Item.</p>
<p>Looking in the <code>Bag.idb</code> in IDA and filtering the functions using &quot;Ctrl + F&quot; and looking for &quot;AddItem&quot;, we find the BagSaveAddItemCore (this function is located in the ARM9 overlay so it can be found in most IDBs).
<img decoding="async" loading="lazy" src="data:image/png;base64,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" width="483" height="219" class="img_ev3q"></p>
<p>This research process will vary depending on what you are trying to implement, keep in mind not every part of the game has been researched at the same level so this step is most of the time the most time-consuming part.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="ida-pseudocode-to-compilable-code">IDA pseudocode to compilable code<a href="#ida-pseudocode-to-compilable-code" class="hash-link" aria-label="Direct link to IDA pseudocode to compilable code" title="Direct link to IDA pseudocode to compilable code">​</a></h3>
<p>Now that we have located the function we want to change we can create a CPP file called <code>DoubleItems.cpp</code> in out <code>Patches</code> folder in Visual Studio.
<img decoding="async" loading="lazy" src="/assets/images/vs_create_cpp_file-85a8aed193f175002ab1fe6824952961.png" width="1734" height="649" class="img_ev3q"></p>
<p>Make sure all your functions are defined and declared inside of the scope of <code>extern &quot;C&quot; { &lt;declarations&gt; }</code></p>
<p>We can start by pasting the pseudo-code from IDA to the CPP file:</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">BagItem </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">__fastcall </span><span class="token function" style="color:#d73a49">BagSave_AddItemCore</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">BagSaveData </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">bag</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> u16 item_idx</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> u16 quantity</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> HeapID heapId</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  BagItem </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">bagItem</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// r0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  bagItem </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">BagSave_GetItemHandleAddCheck</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">bag</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> item_idx</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> quantity</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> heapId</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">!</span><span class="token plain">bagItem </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  bagItem</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain">ItemID </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> item_idx</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  bagItem</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain">Count </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> quantity</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> bagItem</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p>You will see many errors, now we have to define any struct, function or global variable that the function contains.</p>
<p>We don&#x27;t have to declare functions or struct pointers that don&#x27;t get used as a struct, defining them is enough (this is called forward declaration).</p>
<ol>
<li>Always remove <code>__fastcall</code>, it is not necesary and we avoid a compiler warning</li>
<li>We need to tell CTRMap that this function is overriding another one so we use a &quot;tag&quot; before the function name, in this case &quot;THUMB_BRANCH&quot; -&gt; <code>THUMB_BRANCH_BagSave_AddItemCore</code> (for more info on the relocation type tags check the <a href="/docs/generation-v/guides/bw_b2w2-code_injection/#preparing-our-code-for-injection">Code Injection guide</a> )</li>
<li>General <code>typedef</code> like <code>u16</code> are in the <code>swantypes.h</code> file so we include it -&gt; <code>#include &quot;swantypes.h&quot;</code></li>
<li>The <code>HeapID</code> definition is in the <code>gfl/core/gfl_heap.h</code> file so we include it -&gt; <code>#include &quot;gfl/core/gfl_heap.h&quot;</code></li>
<li><code>BagSaveData</code> is only used as a pointer so we can use forward declaration -&gt; <code>struct BagSaveData;</code></li>
<li>Even though <code>BagItem</code> is also a pointer we do use it as a struct so we need to declare it and define it:</li>
</ol>
<ul>
<li>6.1. Go to IDA and open the IDB in use (<code>Bag.idb</code> in this case)</li>
<li>6.2. Go to the <code>Local Types</code> tab (if you don&#x27;t see it use <code>View -&gt; Open Subviews -&gt; Local types</code>)</li>
<li>6.3. Press &quot;Ctrl + F&quot; and type &quot;BagItem&quot; and click on the slot with the same name once</li>
<li>6.4. Press &quot;Ctrl + E&quot;, copy the C struct and paste it in the CPP
<img decoding="async" loading="lazy" src="/assets/images/ida_struct_search-fa78178b80d1fb415741e86a8c264808.png" width="566" height="300" class="img_ev3q"></li>
</ul>
<ol start="7">
<li>The function uses a function called &quot;BagSave_GetItemHandleAddCheck&quot; we can double click it in IDA to get the declaration -&gt; <code>BagItem * BagSave_GetItemHandleAddCheck(BagSaveData *bag, u16 item_idx, u16 quantity, HeapID heapId);</code></li>
<li>To make the changes we want we can analyze the function and see that the quantity to add is added to the bagItem::Count, so to double the items given we can multiply the quantity by 2 -&gt; <code>bagItem-&gt;Count += quantity * 2;</code></li>
<li>Finally we want to print a console message (this is very useful since we can&#x27;t use breakpoints):</li>
</ol>
<ul>
<li>9.1. We include the print header -&gt; <code>#include &quot;kPrint.h&quot;</code></li>
<li>9.2. We make a print call at the end of the function to notify us of what happened -&gt; <code>k::Printf(&quot;Added %d of the following item -&gt; %d\n&quot;, bagItem-&gt;ItemID, bagItem-&gt;Count);</code></li>
</ul>
<p>Now the patch is done and we should have the following code without any visible errors:</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&quot;swantypes.h&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&quot;gfl/core/gfl_heap.h&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;cstdarg&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&quot;kPrint.h&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token class-name">BagSaveData</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token class-name">BagItem</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    u16 ItemID</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    u16 Count</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">extern</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;C&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">BagItem</span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">BagSave_GetItemHandleAddCheck</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">BagSaveData</span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> bag</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> u16 item_idx</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> u16 quantity</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> HeapID heapId</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">BagItem</span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">THUMB_BRANCH_BagSave_AddItemCore</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">BagSaveData</span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> bag</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> u16 item_idx</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> u16 quantity</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> HeapID heapId</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    BagItem</span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> bagItem</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    bagItem </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">BagSave_GetItemHandleAddCheck</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">bag</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> item_idx</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> quantity</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> heapId</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">!</span><span class="token plain">bagItem</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    bagItem</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain">ItemID </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> item_idx</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    bagItem</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain">Count </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> quantity </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    k</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#d73a49">Printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Added %d of the following item -&gt; %d\n&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> quantity </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> bagItem</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain">ItemID</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> bagItem</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="compiling-a-patch">Compiling a patch<a href="#compiling-a-patch" class="hash-link" aria-label="Direct link to Compiling a patch" title="Direct link to Compiling a patch">​</a></h3>
<p>These instructions assume you followed the previous steps, your SWAN headers and other External Dependencies are in the <code>CodeInjection/PW2Code/ExternalDependencies</code> folder and your code in the <code>CodeInjection/PW2Code/Patches</code> folder.</p>
<ol>
<li>Open a cmd terminal in the PW2Code folder (in the &quot;File Explorer&quot; window go the the PW2Code folder, click the path input box, type &quot;cmd&quot; and clik &quot;Enter&quot;)
<img decoding="async" loading="lazy" src="/assets/images/open_cmd-dce24a9be4eed39513df64ec378929cb.png" width="478" height="240" class="img_ev3q"></li>
<li>Paste the following command in the terminal:
<code>arm-none-eabi-g++ Patches/DoubleItems.cpp -I ExternalDependencies/swan -I ExternalDependencies/NitroKernel/include -o DoubleItems.elf -r -mthumb -march=armv5t -Os</code>
General structure of the command for a C++ patch:
<code>arm-none-eabi-g++ [patch path] -I [include directory path] -o [output path] -r -mthumb -march=armv5t -Os</code></li>
</ol>
<p><code>-I</code> is used to provide Additional Include Directories, which are used to search included files outside of the local folder. Since our External Dependencies include files relative to their respective local folder (<code>#include &quot;swantypes.h&quot;</code>) using <code>-I</code> allows this files to compile without changing the source to include from our local folder (<code>#include &quot;../ExternalDependencies/swan/swantypes.h&quot;</code>).
In this particular example we only use <code>-I</code> to include the SWAN and NK directories since they are the only ones we use, you can use it to include as many External Include Directories as you need.</p>
<p>I recommend that you set the output file to be in a specific folder for the ELF files, to keep stuff organized.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="injecting-a-patch">Injecting a patch<a href="#injecting-a-patch" class="hash-link" aria-label="Direct link to Injecting a patch" title="Direct link to Injecting a patch">​</a></h3>
<p>You can use the ESDB in the SWAN headers but I recomend making your own using this <a href="/docs/generation-v/guides/bw_b2w2-code_injection/#building-code-injection-patches">guide</a>.</p>
<p>Once you have the correct ESDB follow these steps:</p>
<ol>
<li>Open your CTRMapProject and go to the &quot;Extras&quot; tab</li>
<li>Click the <code>Convert ELF to DLL</code> button and select the correct ESDB, then the ELF file you just compiled and create the DLL</li>
<li>If the <code>Install to /patches</code> checkbox is not enabled you will have to manually move the DLL to the <code>CTRMapProject/vfs/data/patches</code> folder</li>
<li>Now you can go to <code>File -&gt; Export ROM</code> and your patch should be applied in the exported ROM</li>
</ol>
<p>The patch has been applied to the ROM, and if you play the game you should receive double the items whenever you are given them, also a message should be displayed in the console.</p>
<p>For example, if you buy 5 pokeball you should get 10 in your bag.
<img decoding="async" loading="lazy" src="/assets/images/gameplay-fdc06e21cd9b843d21ac06d950398ffd.png" width="2764" height="970" class="img_ev3q"></p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/ds-pokemon-hacking/ds-pokemon-hacking.github.io/docs/generation-v/guides/b2w2-code_injection_set_up/b2w2-code_injection_set_up.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_VsjB"></div></div></footer></article><nav class="pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/category/guides-1"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Guides</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/generation-v/guides/b2w2-fairy/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Fairy Type Implementation</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#table-of-contents" class="table-of-contents__link toc-highlight">Table of Contents</a></li><li><a href="#environment-set-up" class="table-of-contents__link toc-highlight">Environment set up</a><ul><li><a href="#file-structure" class="table-of-contents__link toc-highlight">File structure</a></li><li><a href="#vs-project-set-up" class="table-of-contents__link toc-highlight">VS Project set up</a></li><li><a href="#ctrmap-set-up" class="table-of-contents__link toc-highlight">CTRMap set up</a></li><li><a href="#ctrmap-project-set-up" class="table-of-contents__link toc-highlight">CTRMap project set up</a></li></ul></li><li><a href="#making-a-code-injection-patch" class="table-of-contents__link toc-highlight">Making a Code Injection patch</a><ul><li><a href="#external-tools" class="table-of-contents__link toc-highlight">External Tools</a></li><li><a href="#idb-research" class="table-of-contents__link toc-highlight">IDB research</a></li><li><a href="#ida-pseudocode-to-compilable-code" class="table-of-contents__link toc-highlight">IDA pseudocode to compilable code</a></li><li><a href="#compiling-a-patch" class="table-of-contents__link toc-highlight">Compiling a patch</a></li><li><a href="#injecting-a-patch" class="table-of-contents__link toc-highlight">Injecting a patch</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 DS Pokémon Hacking. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>